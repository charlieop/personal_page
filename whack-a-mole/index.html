<!DOCTYPE html>
<html>

<head>
    <title>Hammer Game!</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"
        integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
    <script>
        let timeRemaining = 3;          // Amount of time remaining for the countdown

        let timeToShowMonster = 2000   // Amount of time to show the monster
        let timeToHideMonster = 2000;   // Amount of time to hide the monster

        let removeMonster;         // Timeout id for hiding the monster

        let life = 3;                   // The player's life

        function hideMonster() {
            // Change the life and the colour of the holes
            life -= 1;

            // If the game is over show the game over screen
            if (life <= 0) {
                console.log("Game Over!");
                // $("#game-area").hide();
                $("#gameover").fadeIn(1000);
                return;
            }

            // Hide the monster
            $("#monster").hide();
            console.log("hide by timeout");
            console.log(life);

            // Show the monster later again
            newMonster = setTimeout(showMonster, timeToShowMonster);
        }

        function showMonster() {
            // Find the target div randomly and move the monster
            // to that div
            let pos = parseInt(Math.random() * 9);
            let monster = $("#monster");
            monster.appendTo($(".hole")[pos]);
            // Show the monster
            monster.css("display", "block");
            console.log("appear");

            // Hide the monster later
            removeMonster = setTimeout(hideMonster, timeToHideMonster);

        }

        function startGame() {
            // Hide the countdown timer
            $("#countdown").fadeOut(300);
            // Show the monster the first time
            $("#game-area").show();
            setTimeout(showMonster, timeToShowMonster);
            // Set up the click handler of the monster
            // - Clear the previous timeout
            // - Hide the monster
            // - Adjust the monster time
            // - Show the monster later again
            $("#monster").on("click", function () {
                $("#monster").hide();
                console.log("hide");
                clearTimeout(removeMonster);
                setTimeout(showMonster, timeToShowMonster);
            });
        }

        function countdown() {
            // Decrease the remaining time
            if (timeRemaining == 1) {
                $("#bg-monster").slideUp(1000);
            }
            if (timeRemaining > 0) {
                $("#countdown").html(timeRemaining);
                timeRemaining -= 1;
                setTimeout(countdown, 1000);
            }
            else {
                $("#countdown").html("Start!");
                startGame();
            }
            // Continue the countdown if there is still time;
            // otherwise, start the game when the time is up
        }

        $(document).ready(function () {
            // Start the countdown screen
            $("#countdown").html(timeRemaining);
            countdown();
        });
    </script>

    <!-- This is the font returned from Google font -->
    <link href="https://fonts.googleapis.com/css2?family=Gloria+Hallelujah&display=swap" rel="stylesheet">

    <style>
        * {
            box-sizing: border-box;
            font-family: 'Gloria Hallelujah', cursive;
        }

        /* This is the style of the body element */
        body {
            margin: 0;
            padding: 0;
            background: #FFF0F5;
        }

        /* Set the common style for the countdown and gameover divs */
        #countdown,
        #gameover {
            position: absolute;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100vh;
            padding: 0;
            text-align: center;
            font-size: 20vh;
            line-height: 100vh;
            background-color: rgba(0, 0, 0, 0.8);
        }

        /* - Set the properties for the countdown div */
        #countdown {
            color: yellow;
        }

        /* - Set the properties for the gameover div */
        #gameover {
            color: red;
            display: none;
        }

        /* Set the style of the game area */
        #game-area {
            width: 90vmin;
            height: 90vmin;
            margin: 10vmin auto;
            display: none;
        }

        /* - Set the style of the holes */
        .hole {
            /* display: none; */
            width: 25vmin;
            height: 25vmin;
            margin: 2.5vmin;
            /* display: flex; */
            float: left;
            background-color: rgba(255, 248, 220, 0.9);
            border: 5px black solid;
            border-radius: 25px;
        }

        /* - Set the style of the monster image */
        #monster {
            display: none;
            width: 100%;
            margin: auto;
        }

        #bg-monster {
            display: block;
            margin: auto;
            width: 95vmin;
            height: 95vmin;
        }

        .nav_button {
            border: 2px solid;
            border-radius: 5px;
            padding: 5px;
            background-color: #FFF;
            position: fixed;
            top: 10px;
            width: 5rem;
            text-align: center;

        }

        #home {
            color: indianred;
            left: 10px;
            text-decoration: none;
        }
    </style>
</head>

<body>
    <a id="home" class="nav_button" href="../index.html">Home</a>

    <!-- This div contains all holes -->
    <div id="game-area">
        <div class="hole">
            <!-- This is the monster -->
            <img id="monster" src="nomore.png" alt="Nomore monster">
        </div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
        <div class="hole"></div>
    </div>

    <!-- The countdown screen -->
    <img id="bg-monster" src="nomore.png" alt="Nomore monster">
    <div id="countdown">countdown timer here</div>


    <!-- The gameover screen -->
    <div id="gameover">Game Over</div>
</body>

</html>